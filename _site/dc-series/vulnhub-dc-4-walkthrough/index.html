<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.1 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Vulnhub DC-4 Walkthrough | Raju Talukder</title>
<meta name="description" content="This box was so easy. There are only two ports open: SSH and the HTTP server. For the initial foothold, we need to attempt a brute force attack on the login form of the web application. After logging into the application, we can intercept the request and modify the commands. The lack of input validation will give us the command injection vulnerability, allowing us to gain the initial foothold into the box. The privilege escalation is also straightforward. We found a stored password list, and there was a valid password for one user, which allowed SSH login. Checking the mail revealed another user’s password who has some super permissions on a file editor. Using these super permissions, we can edit any file, leading to root access.">


  <meta name="author" content="Raju Talukder">
  
  <meta property="article:author" content="Raju Talukder">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Raju Talukder">
<meta property="og:title" content="Vulnhub DC-4 Walkthrough">
<meta property="og:url" content="http://localhost:4000/dc-series/vulnhub-dc-4-walkthrough/">


  <meta property="og:description" content="This box was so easy. There are only two ports open: SSH and the HTTP server. For the initial foothold, we need to attempt a brute force attack on the login form of the web application. After logging into the application, we can intercept the request and modify the commands. The lack of input validation will give us the command injection vulnerability, allowing us to gain the initial foothold into the box. The privilege escalation is also straightforward. We found a stored password list, and there was a valid password for one user, which allowed SSH login. Checking the mail revealed another user’s password who has some super permissions on a file editor. Using these super permissions, we can edit any file, leading to root access.">







  <meta property="article:published_time" content="2023-10-21T00:00:00+05:30">





  

  


<link rel="canonical" href="http://localhost:4000/dc-series/vulnhub-dc-4-walkthrough/">












<!-- end _includes/seo.html -->


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Raju Talukder
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/"
                
                
              >Home</a>
            </li><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/blogs/"
                
                
              >Blog</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/author/avatar.jpeg" alt="Raju Talukder" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Raju Talukder</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Cybersecurity Engineer, Red &amp; Blue Team Specialist</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Dhaka, Bangladesh</span>
        </li>
      

      
        
          
            <li><a href="mailto:rajutalukder70@mail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://x.com/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-brands fa-x-twitter" aria-hidden="true"></i><span class="label">X</span></a></li>
          
        
          
            <li><a href="https://facebook.com/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://github.com/Raju-Talukder" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://instagram.com/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Vulnhub DC-4 Walkthrough">
    <meta itemprop="description" content="This box was so easy. There are only two ports open: SSH and the HTTP server. For the initial foothold, we need to attempt a brute force attack on the login form of the web application. After logging into the application, we can intercept the request and modify the commands. The lack of input validation will give us the command injection vulnerability, allowing us to gain the initial foothold into the box. The privilege escalation is also straightforward. We found a stored password list, and there was a valid password for one user, which allowed SSH login. Checking the mail revealed another user’s password who has some super permissions on a file editor. Using these super permissions, we can edit any file, leading to root access.">
    <meta itemprop="datePublished" content="2023-10-21T00:00:00+05:30">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://localhost:4000/dc-series/vulnhub-dc-4-walkthrough/" itemprop="url">Vulnhub DC-4 Walkthrough
</a>
          </h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>This box was so easy. There are only two ports open: SSH and the HTTP server. For the initial foothold, we need to attempt a brute force attack on the login form of the web application. After logging into the application, we can intercept the request and modify the commands. The lack of input validation will give us the command injection vulnerability, allowing us to gain the initial foothold into the box. The privilege escalation is also straightforward. We found a stored password list, and there was a valid password for one user, which allowed SSH login. Checking the mail revealed another user’s password who has some super permissions on a file editor. Using these super permissions, we can edit any file, leading to root access.</p>

<h1 id="information-gathering">Information Gathering</h1>

<p>First, I want to start with Nmap to identify the open ports and their associated services. If possible, Nmap will also provide information about the service versions and the operating system. This is a good starting point when working with any assets.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-p22</span>,80 <span class="nt">-sC</span> <span class="nt">-sV</span> 192.168.197.136

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 8d:60:57:06:6c:27:e0:2f:76:2c:e6:42:c0:01:ba:25 <span class="o">(</span>RSA<span class="o">)</span>
|   256 e7:83:8c:d7:bb:84:f3:2e:e8:a2:5f:79:6f:8e:19:30 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 fd:39:47:8a:5e:58:33:99:73:73:9e:22:7f:90:4f:4b <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nginx 1.15.10
|_http-title: System Tools
|_http-server-header: nginx/1.15.10
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div>

<p>From the Nmap scan, I found only two open ports: SSH and the web server. Since there are no credentials, port 22 is not relevant for now. Let’s start hunting through the web server.</p>

<p><strong>Manual Inspection</strong></p>

<p><img src="/assets/images/dc-4/1.png" alt="" /></p>

<p>There is also nothing except the login form. I tried SQL injection, but it did not work. Default passwords did not work, and username enumeration was not successful. So, I tried a brute-force attack with the default admin username, given that it’s a vulnerable box. If it were a real application, I don’t think this would have worked so far. We may need to create a different username and password list to run a more effective brute-force attack.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra <span class="nt">-l</span> admin <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt 192.168.197.136 http-post-form <span class="s1">'/login.php:username=^USER^&amp;password=^PASS^:S=command'</span>

<span class="o">[</span>DATA] attacking http-post-form://192.168.197.136:80/login.php:username<span class="o">=</span>^USER^&amp;password<span class="o">=</span>^PASS^:S<span class="o">=</span><span class="nb">command</span>
<span class="o">[</span>80][http-post-form] host: 192.168.197.136   login: admin   password: happy
1 of 1 target successfully completed, 1 valid password found
</code></pre></div></div>

<p>I’m lucky enough for now, i got the password for the admin user.</p>

<p><img src="/assets/images/dc-4/2.png" alt="" /></p>

<p>There is nothing only command and logout option. So, i go for command.</p>

<p><img src="/assets/images/dc-4/3.png" alt="" /></p>

<p>There is some functionality to run system commands. I plan to intercept the request and try to modify the default command they send. If I can manage to send my own commands, I will find the command injection vulnerability.</p>

<p><img src="/assets/images/dc-4/4.png" alt="" /></p>

<p>They just send plain text commands here, and the server also accepts the modified commands. The command injection vulnerability is confirmed, and we can send a reverse shell command through this vulnerable parameter to get a reverse shell.</p>

<h1 id="initial-foothold">Initial Foothold</h1>

<p><img src="/assets/images/dc-4/5.png" alt="" /></p>

<p>Earlier, I verified the command injection. Then I attempted a bash TCP one-line reverse shell, but it didn’t work for me. After searching for different ways to get a shell, I found that netcat is present inside the box. Now, it’s a piece of cake to get the initial foothold.</p>

<h1 id="privilege-escalation">Privilege Escalation</h1>

<p><img src="/assets/images/dc-4/6.png" alt="" /></p>

<p>After getting the shell as www-data, I searched for the real users on this machine and found 4 users, including root. So, I started looking for files inside the users’ directories.</p>

<p><img src="/assets/images/dc-4/7.png" alt="" /></p>

<p>All the users’ home directories were empty except for Jim’s. There is a directory called ‘backup’ and two files, ‘mbox,’ which is not readable as www-data. The ‘<a href="http://test.sh/">test.sh</a>’ file has full access, and it is an SUID file. I can abuse this file since I have write access to it. However, I saw a password file, and I have three valid users, so it’s better to run an SSH brute force attack now.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra <span class="nt">-L</span> users.txt <span class="nt">-P</span> old_password.bak 192.168.197.136 ssh

<span class="o">[</span>STATUS] 120.33 tries/min, 361 tries <span class="k">in </span>00:03h, 397 to <span class="k">do in </span>00:04h, 14 active
<span class="o">[</span>22][ssh] host: 192.168.197.136   login: jim   password: jibril04
</code></pre></div></div>

<p>SSH brute force successfully manage jim password. so now we can login through ssh as jim.</p>

<p><img src="/assets/images/dc-4/8.png" alt="" /></p>

<p>Now i’m jim through SSH.</p>

<p><img src="/assets/images/dc-4/9.png" alt="" /></p>

<p>Now I can read the ‘mbox’ file; it’s an email. Let’s visit the mail folder for more information. Here is an email from Charles regarding his password. So, now I have Charles’ password as well.</p>

<p><img src="/assets/images/dc-4/10.png" alt="" /></p>

<p>I can normally change the user as chales and i done it here.</p>

<p><img src="/assets/images/dc-4/11.png" alt="" /></p>

<p>Before doing anything, I want to check Charles’ sudo permissions here. I found he has sudo access with no password in the Teehee editor. So, as we have sudo access with a file editor, we can modify any file we want. The very easy way to get root is to add a user with UID and GID 0.</p>

<p><img src="/assets/images/dc-4/12.png" alt="" /></p>

<p>Here i add raaj user with UID and GI 0 means its root user.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"raaj::0:0:::/bin/bash"</span> | <span class="nb">sudo </span>teehee <span class="nt">-a</span> /etc/passwd
</code></pre></div></div>

<p><img src="/assets/images/dc-4/13.png" alt="" /></p>

<p>Now, just change the user to <code class="language-plaintext highlighter-rouge">raaj</code> and we are root because we set the UID and GID for the <code class="language-plaintext highlighter-rouge">raaj</code> user as 0. In the Linux file system, the UID and GID 0 are always reserved for the root.</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#dc-series" class="page__taxonomy-item p-category" rel="tag">DC-Series</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2023-10-21T00:00:00+05:30">October 21, 2023</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/dc-series/Vulnhub-dc-3-walkthrough/" class="pagination--pager" title="Vulnhub DC-3 Walkthrough">Previous</a>
    
    
      <a href="/dc-series/vulnhub-dc-5-walkthrough/" class="pagination--pager" title="Vulnhub DC-5 Walkthrough">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
  
        <!-- 

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="mailto:rajutalukder70@mail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
        
      
        
          <li><a href="https://x.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-brands fa-x-twitter" aria-hidden="true"></i> X</a></li>
        
      
        
          <li><a href="https://facebook.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://github.com/Raju-Talukder" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 <a href="http://localhost:4000">Raju Talukder</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div> -->

<div class="page__footer-follow text-center">
  <ul class="social-icons d-inline-flex justify-content-center">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li class="mx-2">
            <a href="mailto:rajutalukder70@mail.com" rel="nofollow noopener noreferrer">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
            </a>
          </li>
        
      
        
          <li class="mx-2">
            <a href="https://x.com/" rel="nofollow noopener noreferrer">
              <i class="fab fa-fw fa-brands fa-x-twitter" aria-hidden="true"></i> X
            </a>
          </li>
        
      
        
          <li class="mx-2">
            <a href="https://facebook.com/" rel="nofollow noopener noreferrer">
              <i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook
            </a>
          </li>
        
      
        
          <li class="mx-2">
            <a href="https://github.com/Raju-Talukder" rel="nofollow noopener noreferrer">
              <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
            </a>
          </li>
        
      
        
          <li class="mx-2">
            <a href="https://instagram.com/" rel="nofollow noopener noreferrer">
              <i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram
            </a>
          </li>
        
      
    

    
  </ul>
</div>

<div class="page__footer-copyright text-center">
  &copy; 2025 <a href="http://localhost:4000">Raju Talukder</a>.
  Powered by
  <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp;
  <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.
</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
